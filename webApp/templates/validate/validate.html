{% extends "static/base.html" %}
{% block body %}
    {% include "static/nav.html" %}
	
	<div id="alert-container" class="w-50"></div>

    <div class="container-fluid mt-3">
        <div class="row">
			<div class="col-12 mx-auto">
				<div class="card border-{{ 'success' if page_data.valid_bool else 'danger' }}">
					<div class="card-header">
						<h3>Status</h3>
					</div>
					<div class="card-body">
						<p>Valid: {{ page_data.valid_bool }}</p>
						<p>{{ page_data.valid_msg }}</p>
					</div>
				</div>
			</div>

            <div class="col-12" style="height: 1.25em;"></div>
			
			<div class="col-12 mx-auto">
				<div class="card">
					<div class="card-header">
						<h3 class="float-left">Schema</h3>

						<div class="float-right btn-group">
							<button type="button" class="btn btn-outline-secondary" onclick="format('schema')">Verbose</button>
							<button type="button" class="btn btn-outline-secondary" onclick="minify('schema')">Minify</button>
						</div>
					</div>
					<div id="schema" class="card-body scroll code">{{ page_data.schema }}</div>
				</div>
			</div>

            <div class="col-12" style="height: 1.25em;"></div>

            <div class="col-12 mx-auto">
				<h3>Message - {{ page_data.message_type }}</h3>
				
				{% if page_data.message_format != 'json' %}
					<ul class="nav nav-tabs">
						<li class="nav-item">
							<a class="nav-link" data-toggle="tab" href="#json-card">JSON</a>
						</li>
						<li class="nav-item">
							<a class="nav-link active show" data-toggle="tab" href="#message-card">{{ page_data.message_format|upper }} <span class="badge badge-pill badge-info">Original</span>
</a>
						</li>
					</ul>
					
					<div class="tab-content">					
						<div id="json-card" class="tab-pane fade">
							<div class="card">
								<div class="card-header">
									<h3 class="float-left">JSON</h3>

									<div class="float-right btn-group">
										<button type="button" class="btn btn-outline-secondary" onclick="format('message-json', indent, 'json')">Verbose</button>
										<button type="button" class="btn btn-outline-secondary" onclick="minify('message-json', 'json')">Minify</button>
									</div>
								</div>
								<div id="message-json" class="card-body scroll code">{{ page_data.message_json }}</div>
							</div>
						</div>
				{% endif %}
						
				<div id="message-card" class="tab-pane fade active show">
					<div class="card">
						<div class="card-header">
							<h3 class="float-left"><span id="message-format">{{ page_data.message_format|upper }}</span></h3>

							<div class="float-right btn-group">
								<button type="button" class="btn btn-outline-secondary" onclick="format('message')">Verbose</button>
								<button type="button" class="btn btn-outline-secondary" onclick="minify('message')">Minify</button>
							</div>
						</div>
						<div id="message" class="card-body scroll code">{{ page_data.message_original }}</div>
					</div>
				</div>
				{{ '' if page_data.message_format == 'json' else '</div>'|safe }}
			</div>
        </div>
		
		<div class="col-12" style="height: 1.25em;"></div>
    </div>
{% endblock %}

{% block page_script %}
<script type="text/javascript" src="{{ url_for('static', filename='js/vkbeautify.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/utils.js') }}"></script>
<script type="text/javascript">	
	if ($("#message-json").length == 1) {
		format('message-json', indent, 'json')
	}
	msg_format = "{{ page_data.message_format }}"
	switch(msg_format) {
		case 'cbor':
			minify('message')
			break;
		default:
			format('message')
			break;
    }
</script>
{% endblock %}