syntax = "proto3";
//        title: "OpenC2 Language Profile"
package org.oasis-open.openc2.oc2ls.v1-1;
//  description: "Language Profile from the OpenC2 Language Specification version 1.1"
//      exports: ["OpenC2-Command", "OpenC2-Response"]


// The Command defines an Action to be performed on a Target
message OpenC2-Command {
  Action      action =      1;   
  Target      target =      2;   
  Args        args =        3;   
  Actuator    actuator =    4;   
  Command-ID  command_id =  5;   
}

message OpenC2-Response {
  Status-Code  status =       1;   
  string       status_text =  2;   
  Results      results =      3;   
}

enum Action {
  Unknown_Action =  0;   // required starting enum number for protobuf3 
  scan =            1;                                                  
  locate =          2;                                                  
  query =           3;                                                  
  deny =            6;                                                  
  contain =         7;                                                  
  allow =           8;                                                  
  start =           9;                                                  
  stop =            10;                                                 
  restart =         11;                                                 
  cancel =          14;                                                 
  set =             15;                                                 
  update =          16;                                                 
  redirect =        18;                                                 
  create =          19;                                                 
  delete =          20;                                                 
  detonate =        22;                                                 
  restore =         23;                                                 
  copy =            28;                                                 
  investigate =     30;                                                 
  remediate =       32;                                                 
}

message Target {
  oneof Target {
    Artifact         artifact =         1;    
    Command-ID       command =          2;    
    Device           device =           3;    
    Domain-Name      domain_name =      7;    
    Email-Addr       email_addr =       8;    
    Features         features =         9;    
    File             file =             10;   
    IDN-Domain-Name  idn_domain_name =  11;   
    IDN-Email-Addr   idn_email_addr =   12;   
    IPv4-Net         ipv4_net =         13;   
    IPv6-Net         ipv6_net =         14;   
    IPv4-Connection  ipv4_connection =  15;   
    IPv6-Connection  ipv6_connection =  16;   
    IRI              iri =              20;   
    MAC-Addr         mac_addr =         17;   
    Process          process =          18;   
    Properties       properties =       25;   
    URI              uri =              19;   
}


message Actuator {
  oneof Actuator {
  
}


message Args {
  Date-Time      start_time =          1;   
  Date-Time      stop_time =           2;   
  Duration       duration =            3;   
  Response-Type  response_requested =  4;   
}

enum Status-Code {
  Unknown_Status_Code =  0;    // required starting enum number for protobuf3 
  Processing =           102;                                                 
  OK =                   200;                                                 
  Created =              201;                                                 
  Bad_Request =          400;                                                 
  Unauthorized =         401;                                                 
  Forbidden =            403;                                                 
  Not_Found =            404;                                                 
  Internal_Error =       500;                                                 
  Not_Implemented =      501;                                                 
  Service_Unavailable =  503;                                                 
}

// Response Results
message Results {
  Results$Versions    versions =    1;   
  Results$Profiles    profiles =    2;   
  Action-Targets      pairs =       3;   
  Results$rate-limit  rate_limit =  4;   
  Results$Args        args =        5;   
}

message Artifact {
  string   mime_type =  1;   
  Payload  payload =    2;   
  Hashes   hashes =     3;   
}

message Device {
  Hostname      hostname =      1;   
  IDN-Hostname  idn_hostname =  2;   
  string        device_id =     3;   
}

// $Domain-Name(String) {'format': 'hostname'}

// $Email-Addr(String) {'format': 'email'}

// $Features(ArrayOf) {'vtype': 'Feature', 'maxv': 10, 'unique': True}

message File {
  string  name =    1;   
  string  path =    2;   
  Hashes  hashes =  3;   
}

// $IDN-Domain-Name(String) {'format': 'idn-hostname'}

// $IDN-Email-Addr(String) {'format': 'idn-email'}

// $IPv4-Net(Array) {'format': 'ipv4-net'}

// 5-tuple that specifies a tcp/ip connection
message IPv4-Connection {
  IPv4-Net     src_addr =  1;   
  Port         src_port =  2;   
  IPv4-Net     dst_addr =  3;   
  Port         dst_port =  4;   
  L4-Protocol  protocol =  5;   
}

// $IPv6-Net(Array) {'format': 'ipv6-net'}

// 5-tuple that specifies a tcp/ip connection
message IPv6-Connection {
  IPv6-Net     src_addr =  1;   
  Port         src_port =  2;   
  IPv6-Net     dst_addr =  3;   
  Port         dst_port =  4;   
  L4-Protocol  protocol =  5;   
}

// $IRI(String) {'format': 'iri'}

// $MAC-Addr(Binary) {'format': 'eui'}

message Process {
  Process$pid  pid =           1;   
  string       name =          2;   
  string       cwd =           3;   
  File         executable =    4;   
  Process      parent =        5;   
  string       command_line =  6;   
}

// $Properties(ArrayOf) {'vtype': 'String', 'minv': 1, 'unique': True}

// $URI(String) {'format': 'uri'}

// Map of each action supported by this actuator to the list of targets applicable to that action
message Action-Targets {
  Targets  scan =         1;    
  Targets  locate =       2;    
  Targets  query =        3;    
  Targets  deny =         6;    
  Targets  contain =      7;    
  Targets  allow =        8;    
  Targets  start =        9;    
  Targets  stop =         10;   
  Targets  restart =      11;   
  Targets  cancel =       14;   
  Targets  set =          15;   
  Targets  update =       16;   
  Targets  redirect =     18;   
  Targets  create =       19;   
  Targets  delete =       20;   
  Targets  detonate =     22;   
  Targets  restore =      23;   
  Targets  copy =         28;   
  Targets  investigate =  30;   
  Targets  remediate =    32;   
}

// $Targets(ArrayOf) {'vtype': 'Target$Pointer', 'minv': 1, 'maxv': 0, 'unique': True}

// $Date-Time(Integer) {'minv': 0}

// $Duration(Integer) {'minv': 0}

// Specifies the results to be returned from a query features Command
enum Feature {
  Unknown_Feature =  0;  // required starting enum number for protobuf3 
  versions =         1;                                                 
  profiles =         2;                                                 
  pairs =            3;                                                 
  rate_limit =       4;                                                 
  args =             5;                                                 
}

// Cryptographic hash values
message Hashes {
  Hashes$md5     md5 =     1;   
  Hashes$sha1    sha1 =    2;   
  Hashes$sha256  sha256 =  3;   
}

// $Hostname(String) {'format': 'hostname'}

// $IDN-Hostname(String) {'format': 'idn-hostname'}

// $IPv4-Addr(Binary) {'format': 'ipv4-addr'}

// $IPv6-Addr(Binary) {'format': 'ipv6-addr'}

// Value of the protocol (IPv4) or next header (IPv6) field in an IP packet. Any IANA value, [RFC5237]
enum L4-Protocol {
  Unknown_L4_Protocol =  0;    // required starting enum number for protobuf3 
  icmp =                 1;                                                   
  tcp =                  6;                                                   
  udp =                  17;                                                  
  sctp =                 132;                                                 
}

message Payload {
  oneof Payload {
    string  bin =  1;   
    URI     url =  2;   
}


// $Port(Integer) {'minv': 0, 'maxv': 65535}

enum Response-Type {
  none =      0;   
  ack =       1;   
  status =    2;   
  complete =  3;   
}

// $Version(String) {}

// $Command-ID(String) {'pattern': '^\\S{0,36}$'}

// $Namespace(String) {'format': 'uri'}

// $Results$Versions(ArrayOf) {'vtype': 'Version', 'minv': 1, 'maxv': 10, 'unique': True}

// $Results$Profiles(ArrayOf) {'vtype': 'Namespace', 'minv': 1, 'unique': True}

// $Results$Args(ArrayOf) {'vtype': 'Enumerated', 'minv': 1}

// $Results$rate-limit(Number) {'minf': 0.0}

// $Process$pid(Integer) {'minv': 0}

// $Hashes$md5(Binary) {'format': 'x', 'minv': 16, 'maxv': 16}

// $Hashes$sha1(Binary) {'format': 'x', 'minv': 20, 'maxv': 20}

// $Hashes$sha256(Binary) {'format': 'x', 'minv': 32, 'maxv': 32}

enum Target$Pointer {
  Unknown_Target$Pointer =  0;   // required starting enum number for protobuf3 
  artifact =                1;                                                  
  command =                 2;                                                  
  device =                  3;                                                  
  domain_name =             4;                                                  
  email_addr =              5;                                                  
  features =                6;                                                  
  file =                    7;                                                  
  idn_domain_name =         8;                                                  
  idn_email_addr =          9;                                                  
  ipv4_net =                10;                                                 
  ipv6_net =                11;                                                 
  ipv4_connection =         12;                                                 
  ipv6_connection =         13;                                                 
  iri =                     14;                                                 
  mac_addr =                15;                                                 
  process =                 16;                                                 
  properties =              17;                                                 
  uri =                     18;                                                 
}
